{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "9eb57e84",
   "metadata": {
    "_cell_guid": "b1076dfc-b9ad-4769-8c92-a6c4dae69d19",
    "_uuid": "8f2839f25d086af736a60e9eeb907d3b93b6e0e5",
    "execution": {
     "iopub.execute_input": "2026-01-04T00:39:25.198419Z",
     "iopub.status.busy": "2026-01-04T00:39:25.197948Z",
     "iopub.status.idle": "2026-01-04T00:39:26.652413Z",
     "shell.execute_reply": "2026-01-04T00:39:26.650288Z"
    },
    "papermill": {
     "duration": 1.46406,
     "end_time": "2026-01-04T00:39:26.656194",
     "exception": false,
     "start_time": "2026-01-04T00:39:25.192134",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/kaggle/input/playground-series-s6e1/sample_submission.csv\n",
      "/kaggle/input/playground-series-s6e1/train.csv\n",
      "/kaggle/input/playground-series-s6e1/test.csv\n"
     ]
    }
   ],
   "source": [
    "# This Python 3 environment comes with many helpful analytics libraries installed\n",
    "# It is defined by the kaggle/python Docker image: https://github.com/kaggle/docker-python\n",
    "# For example, here's several helpful packages to load\n",
    "\n",
    "import numpy as np # linear algebra\n",
    "import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)\n",
    "\n",
    "# Input data files are available in the read-only \"../input/\" directory\n",
    "# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n",
    "\n",
    "import os\n",
    "for dirname, _, filenames in os.walk('/kaggle/input'):\n",
    "    for filename in filenames:\n",
    "        print(os.path.join(dirname, filename))\n",
    "\n",
    "# You can write up to 20GB to the current directory (/kaggle/working/) that gets preserved as output when you create a version using \"Save & Run All\" \n",
    "# You can also write temporary files to /kaggle/temp/, but they won't be saved outside of the current session"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "a1bcdd1e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-04T00:39:26.665117Z",
     "iopub.status.busy": "2026-01-04T00:39:26.664553Z",
     "iopub.status.idle": "2026-01-04T00:39:29.550552Z",
     "shell.execute_reply": "2026-01-04T00:39:29.548263Z"
    },
    "papermill": {
     "duration": 2.893859,
     "end_time": "2026-01-04T00:39:29.553612",
     "exception": false,
     "start_time": "2026-01-04T00:39:26.659753",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "from sklearn.preprocessing import OneHotEncoder, OrdinalEncoder, StandardScaler\n",
    "from sklearn.compose import ColumnTransformer\n",
    "from sklearn.pipeline import Pipeline\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "8d50d976",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-04T00:39:29.561423Z",
     "iopub.status.busy": "2026-01-04T00:39:29.560922Z",
     "iopub.status.idle": "2026-01-04T00:39:31.583168Z",
     "shell.execute_reply": "2026-01-04T00:39:31.581951Z"
    },
    "papermill": {
     "duration": 2.029714,
     "end_time": "2026-01-04T00:39:31.586350",
     "exception": false,
     "start_time": "2026-01-04T00:39:29.556636",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "df_train = pd.read_csv('/kaggle/input/playground-series-s6e1/train.csv')\n",
    "df_test = pd.read_csv('/kaggle/input/playground-series-s6e1/test.csv')\n",
    "binary_columns = ['internet_access']\n",
    "for col in binary_columns:\n",
    "    df_train[col] = df_train[col].map({\"yes\": 1, \"no\": 0})\n",
    "    df_test[col]  = df_test[col].map({\"yes\": 1, \"no\": 0})\n",
    "\n",
    "\n",
    "X_train = df_train.drop(columns='exam_score', axis=1)\n",
    "Y_train = df_train['exam_score']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "66c3d6ff",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-04T00:39:31.594043Z",
     "iopub.status.busy": "2026-01-04T00:39:31.593572Z",
     "iopub.status.idle": "2026-01-04T00:39:31.603024Z",
     "shell.execute_reply": "2026-01-04T00:39:31.601661Z"
    },
    "papermill": {
     "duration": 0.01753,
     "end_time": "2026-01-04T00:39:31.606931",
     "exception": false,
     "start_time": "2026-01-04T00:39:31.589401",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['id', 'age', 'gender', 'course', 'study_hours', 'class_attendance',\n",
       "       'internet_access', 'sleep_hours', 'sleep_quality', 'study_method',\n",
       "       'facility_rating', 'exam_difficulty', 'exam_score'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_train.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "2cc7750b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-04T00:39:31.616703Z",
     "iopub.status.busy": "2026-01-04T00:39:31.616291Z",
     "iopub.status.idle": "2026-01-04T00:39:31.623004Z",
     "shell.execute_reply": "2026-01-04T00:39:31.621895Z"
    },
    "papermill": {
     "duration": 0.01473,
     "end_time": "2026-01-04T00:39:31.626208",
     "exception": false,
     "start_time": "2026-01-04T00:39:31.611478",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "ordinal_columns = ['sleep_quality', 'facility_rating', 'exam_difficulty']\n",
    "one_hot_columns = ['gender', 'study_method', 'course']\n",
    "\n",
    "\n",
    "orden_categorias = [\n",
    "    ['poor', 'average', 'good'],\n",
    "    ['low', 'medium', 'high'],\n",
    "    ['easy', 'moderate','hard']\n",
    "]\n",
    "\n",
    "scaling_features = ['study_hours', 'age', 'class_attendance', 'sleep_hours']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "34b1cda8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-04T00:39:31.634925Z",
     "iopub.status.busy": "2026-01-04T00:39:31.634546Z",
     "iopub.status.idle": "2026-01-04T00:39:31.641316Z",
     "shell.execute_reply": "2026-01-04T00:39:31.640221Z"
    },
    "papermill": {
     "duration": 0.01436,
     "end_time": "2026-01-04T00:39:31.643572",
     "exception": false,
     "start_time": "2026-01-04T00:39:31.629212",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "from sklearn.compose import ColumnTransformer\n",
    "from sklearn.pipeline import Pipeline\n",
    "\n",
    "onehot = OneHotEncoder(handle_unknown='ignore')\n",
    "ordinal = OrdinalEncoder(categories=orden_categorias)\n",
    "scaler = StandardScaler()\n",
    "\n",
    "preprocessor = ColumnTransformer(\n",
    "    transformers=[\n",
    "        ('onehot', onehot, one_hot_columns),\n",
    "        ('ordinal', ordinal, ordinal_columns),\n",
    "        ('scaler', scaler, scaling_features)\n",
    "    ],\n",
    "    remainder='passthrough'\n",
    ")\n",
    "\n",
    "pipeline = Pipeline(steps=[\n",
    "    ('preprocessor', preprocessor)\n",
    "])    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "fd22e976",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-04T00:39:31.651918Z",
     "iopub.status.busy": "2026-01-04T00:39:31.651545Z",
     "iopub.status.idle": "2026-01-04T00:39:33.355390Z",
     "shell.execute_reply": "2026-01-04T00:39:33.354360Z"
    },
    "papermill": {
     "duration": 1.710928,
     "end_time": "2026-01-04T00:39:33.357773",
     "exception": false,
     "start_time": "2026-01-04T00:39:31.646845",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "X_train_proc = pipeline.fit_transform(X_train)\n",
    "X_test_proc = pipeline.transform(df_test)\n",
    "\n",
    "col_names = pipeline.named_steps['preprocessor'].get_feature_names_out()\n",
    "\n",
    "df_train_proc = pd.DataFrame(X_train_proc, columns=col_names)\n",
    "df_test_proc = pd.DataFrame(X_test_proc, columns=col_names)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "a5cf53cf",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-04T00:39:33.366263Z",
     "iopub.status.busy": "2026-01-04T00:39:33.365467Z",
     "iopub.status.idle": "2026-01-04T00:39:33.675431Z",
     "shell.execute_reply": "2026-01-04T00:39:33.673161Z"
    },
    "papermill": {
     "duration": 0.317123,
     "end_time": "2026-01-04T00:39:33.678007",
     "exception": false,
     "start_time": "2026-01-04T00:39:33.360884",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>onehot__gender_female</th>\n",
       "      <th>onehot__gender_male</th>\n",
       "      <th>onehot__gender_other</th>\n",
       "      <th>onehot__study_method_coaching</th>\n",
       "      <th>onehot__study_method_group study</th>\n",
       "      <th>onehot__study_method_mixed</th>\n",
       "      <th>onehot__study_method_online videos</th>\n",
       "      <th>onehot__study_method_self-study</th>\n",
       "      <th>onehot__course_b.com</th>\n",
       "      <th>onehot__course_b.sc</th>\n",
       "      <th>...</th>\n",
       "      <th>onehot__course_diploma</th>\n",
       "      <th>ordinal__sleep_quality</th>\n",
       "      <th>ordinal__facility_rating</th>\n",
       "      <th>ordinal__exam_difficulty</th>\n",
       "      <th>scaler__study_hours</th>\n",
       "      <th>scaler__age</th>\n",
       "      <th>scaler__class_attendance</th>\n",
       "      <th>scaler__sleep_hours</th>\n",
       "      <th>remainder__id</th>\n",
       "      <th>remainder__internet_access</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.655875</td>\n",
       "      <td>0.200943</td>\n",
       "      <td>1.538302</td>\n",
       "      <td>-1.245269</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.401573</td>\n",
       "      <td>-1.126352</td>\n",
       "      <td>1.308814</td>\n",
       "      <td>-1.359895</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.287160</td>\n",
       "      <td>-0.241488</td>\n",
       "      <td>1.182595</td>\n",
       "      <td>-0.729454</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>-0.848492</td>\n",
       "      <td>-0.683920</td>\n",
       "      <td>-1.290141</td>\n",
       "      <td>0.703367</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.545699</td>\n",
       "      <td>1.085807</td>\n",
       "      <td>0.855575</td>\n",
       "      <td>1.448434</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>629995</th>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.363435</td>\n",
       "      <td>-1.126352</td>\n",
       "      <td>-0.073853</td>\n",
       "      <td>-1.703772</td>\n",
       "      <td>629995.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>629996</th>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.304162</td>\n",
       "      <td>0.200943</td>\n",
       "      <td>-1.009018</td>\n",
       "      <td>-1.474521</td>\n",
       "      <td>629996.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>629997</th>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>-1.424793</td>\n",
       "      <td>1.528239</td>\n",
       "      <td>-1.594213</td>\n",
       "      <td>-1.589146</td>\n",
       "      <td>629997.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>629998</th>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>-1.043417</td>\n",
       "      <td>-0.241488</td>\n",
       "      <td>0.178584</td>\n",
       "      <td>0.646054</td>\n",
       "      <td>629998.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>629999</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>-0.026416</td>\n",
       "      <td>-1.126352</td>\n",
       "      <td>0.190059</td>\n",
       "      <td>-0.729454</td>\n",
       "      <td>629999.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>630000 rows × 24 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        onehot__gender_female  onehot__gender_male  onehot__gender_other  \\\n",
       "0                         1.0                  0.0                   0.0   \n",
       "1                         0.0                  0.0                   1.0   \n",
       "2                         1.0                  0.0                   0.0   \n",
       "3                         0.0                  1.0                   0.0   \n",
       "4                         0.0                  1.0                   0.0   \n",
       "...                       ...                  ...                   ...   \n",
       "629995                    1.0                  0.0                   0.0   \n",
       "629996                    1.0                  0.0                   0.0   \n",
       "629997                    0.0                  1.0                   0.0   \n",
       "629998                    0.0                  1.0                   0.0   \n",
       "629999                    0.0                  0.0                   1.0   \n",
       "\n",
       "        onehot__study_method_coaching  onehot__study_method_group study  \\\n",
       "0                                 0.0                               0.0   \n",
       "1                                 0.0                               0.0   \n",
       "2                                 1.0                               0.0   \n",
       "3                                 0.0                               1.0   \n",
       "4                                 0.0                               0.0   \n",
       "...                               ...                               ...   \n",
       "629995                            0.0                               0.0   \n",
       "629996                            0.0                               0.0   \n",
       "629997                            0.0                               0.0   \n",
       "629998                            0.0                               1.0   \n",
       "629999                            0.0                               0.0   \n",
       "\n",
       "        onehot__study_method_mixed  onehot__study_method_online videos  \\\n",
       "0                              0.0                                 1.0   \n",
       "1                              0.0                                 0.0   \n",
       "2                              0.0                                 0.0   \n",
       "3                              0.0                                 0.0   \n",
       "4                              0.0                                 0.0   \n",
       "...                            ...                                 ...   \n",
       "629995                         1.0                                 0.0   \n",
       "629996                         1.0                                 0.0   \n",
       "629997                         0.0                                 1.0   \n",
       "629998                         0.0                                 0.0   \n",
       "629999                         0.0                                 1.0   \n",
       "\n",
       "        onehot__study_method_self-study  onehot__course_b.com  \\\n",
       "0                                   0.0                   0.0   \n",
       "1                                   1.0                   0.0   \n",
       "2                                   0.0                   0.0   \n",
       "3                                   0.0                   0.0   \n",
       "4                                   1.0                   0.0   \n",
       "...                                 ...                   ...   \n",
       "629995                              0.0                   0.0   \n",
       "629996                              0.0                   0.0   \n",
       "629997                              0.0                   0.0   \n",
       "629998                              0.0                   1.0   \n",
       "629999                              0.0                   0.0   \n",
       "\n",
       "        onehot__course_b.sc  ...  onehot__course_diploma  \\\n",
       "0                       1.0  ...                     0.0   \n",
       "1                       0.0  ...                     1.0   \n",
       "2                       1.0  ...                     0.0   \n",
       "3                       1.0  ...                     0.0   \n",
       "4                       0.0  ...                     0.0   \n",
       "...                     ...  ...                     ...   \n",
       "629995                  0.0  ...                     0.0   \n",
       "629996                  0.0  ...                     0.0   \n",
       "629997                  0.0  ...                     0.0   \n",
       "629998                  0.0  ...                     0.0   \n",
       "629999                  0.0  ...                     0.0   \n",
       "\n",
       "        ordinal__sleep_quality  ordinal__facility_rating  \\\n",
       "0                          1.0                       0.0   \n",
       "1                          0.0                       1.0   \n",
       "2                          0.0                       2.0   \n",
       "3                          1.0                       2.0   \n",
       "4                          2.0                       2.0   \n",
       "...                        ...                       ...   \n",
       "629995                     2.0                       2.0   \n",
       "629996                     1.0                       0.0   \n",
       "629997                     0.0                       0.0   \n",
       "629998                     1.0                       2.0   \n",
       "629999                     0.0                       0.0   \n",
       "\n",
       "        ordinal__exam_difficulty  scaler__study_hours  scaler__age  \\\n",
       "0                            0.0             1.655875     0.200943   \n",
       "1                            1.0             0.401573    -1.126352   \n",
       "2                            1.0             0.287160    -0.241488   \n",
       "3                            1.0            -0.848492    -0.683920   \n",
       "4                            0.0             1.545699     1.085807   \n",
       "...                          ...                  ...          ...   \n",
       "629995                       1.0             0.363435    -1.126352   \n",
       "629996                       1.0             1.304162     0.200943   \n",
       "629997                       1.0            -1.424793     1.528239   \n",
       "629998                       1.0            -1.043417    -0.241488   \n",
       "629999                       0.0            -0.026416    -1.126352   \n",
       "\n",
       "        scaler__class_attendance  scaler__sleep_hours  remainder__id  \\\n",
       "0                       1.538302            -1.245269            0.0   \n",
       "1                       1.308814            -1.359895            1.0   \n",
       "2                       1.182595            -0.729454            2.0   \n",
       "3                      -1.290141             0.703367            3.0   \n",
       "4                       0.855575             1.448434            4.0   \n",
       "...                          ...                  ...            ...   \n",
       "629995                 -0.073853            -1.703772       629995.0   \n",
       "629996                 -1.009018            -1.474521       629996.0   \n",
       "629997                 -1.594213            -1.589146       629997.0   \n",
       "629998                  0.178584             0.646054       629998.0   \n",
       "629999                  0.190059            -0.729454       629999.0   \n",
       "\n",
       "        remainder__internet_access  \n",
       "0                              0.0  \n",
       "1                              1.0  \n",
       "2                              1.0  \n",
       "3                              1.0  \n",
       "4                              1.0  \n",
       "...                            ...  \n",
       "629995                         1.0  \n",
       "629996                         1.0  \n",
       "629997                         1.0  \n",
       "629998                         1.0  \n",
       "629999                         1.0  \n",
       "\n",
       "[630000 rows x 24 columns]"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_train_proc"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "138afa3d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-04T00:39:33.690579Z",
     "iopub.status.busy": "2026-01-04T00:39:33.688160Z",
     "iopub.status.idle": "2026-01-04T00:39:34.362418Z",
     "shell.execute_reply": "2026-01-04T00:39:34.361572Z"
    },
    "papermill": {
     "duration": 0.691743,
     "end_time": "2026-01-04T00:39:34.373352",
     "exception": false,
     "start_time": "2026-01-04T00:39:33.681609",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MSE:  78.9788639096609\n",
      "RMSE 8.88700533980153\n"
     ]
    }
   ],
   "source": [
    "from sklearn.linear_model import LinearRegression\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.metrics import mean_squared_error\n",
    "\n",
    "X_train, X_val, y_train, y_val = train_test_split(\n",
    "    df_train_proc, Y_train, test_size=0.2, random_state=42\n",
    ")\n",
    "\n",
    "model = LinearRegression()\n",
    "model.fit(X_train, y_train)\n",
    "\n",
    "y_pred = model.predict(X_val)\n",
    "\n",
    "mse = mean_squared_error(y_val, y_pred)\n",
    "rmse = np.sqrt(mse)\n",
    "\n",
    "print('MSE: ', mse)\n",
    "print('RMSE',  rmse)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "1a05b4f4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-04T00:39:34.409026Z",
     "iopub.status.busy": "2026-01-04T00:39:34.408603Z",
     "iopub.status.idle": "2026-01-04T00:39:34.736669Z",
     "shell.execute_reply": "2026-01-04T00:39:34.735649Z"
    },
    "papermill": {
     "duration": 0.347242,
     "end_time": "2026-01-04T00:39:34.739333",
     "exception": false,
     "start_time": "2026-01-04T00:39:34.392091",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/usr/local/lib/python3.12/dist-packages/sklearn/utils/validation.py:2739: UserWarning: X does not have valid feature names, but LinearRegression was fitted with feature names\n",
      "  warnings.warn(\n"
     ]
    }
   ],
   "source": [
    "predictions = model.predict(X_test_proc)\n",
    "\n",
    "submission = pd.DataFrame(list(zip(df_test['id'], predictions)), columns=['id', 'exam_score'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "ba9b6f49",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-04T00:39:34.749559Z",
     "iopub.status.busy": "2026-01-04T00:39:34.748382Z",
     "iopub.status.idle": "2026-01-04T00:39:34.760241Z",
     "shell.execute_reply": "2026-01-04T00:39:34.758897Z"
    },
    "papermill": {
     "duration": 0.01996,
     "end_time": "2026-01-04T00:39:34.762957",
     "exception": false,
     "start_time": "2026-01-04T00:39:34.742997",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>exam_score</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>630000</td>\n",
       "      <td>71.844977</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>630001</td>\n",
       "      <td>69.568877</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>630002</td>\n",
       "      <td>87.487872</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>630003</td>\n",
       "      <td>54.739075</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>630004</td>\n",
       "      <td>47.173639</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>269995</th>\n",
       "      <td>899995</td>\n",
       "      <td>60.745063</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>269996</th>\n",
       "      <td>899996</td>\n",
       "      <td>38.972858</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>269997</th>\n",
       "      <td>899997</td>\n",
       "      <td>90.038253</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>269998</th>\n",
       "      <td>899998</td>\n",
       "      <td>55.564388</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>269999</th>\n",
       "      <td>899999</td>\n",
       "      <td>68.468935</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>270000 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            id  exam_score\n",
       "0       630000   71.844977\n",
       "1       630001   69.568877\n",
       "2       630002   87.487872\n",
       "3       630003   54.739075\n",
       "4       630004   47.173639\n",
       "...        ...         ...\n",
       "269995  899995   60.745063\n",
       "269996  899996   38.972858\n",
       "269997  899997   90.038253\n",
       "269998  899998   55.564388\n",
       "269999  899999   68.468935\n",
       "\n",
       "[270000 rows x 2 columns]"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "submission"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "41046ef0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-04T00:39:34.773233Z",
     "iopub.status.busy": "2026-01-04T00:39:34.772863Z",
     "iopub.status.idle": "2026-01-04T00:39:35.374539Z",
     "shell.execute_reply": "2026-01-04T00:39:35.373408Z"
    },
    "papermill": {
     "duration": 0.610115,
     "end_time": "2026-01-04T00:39:35.377113",
     "exception": false,
     "start_time": "2026-01-04T00:39:34.766998",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "submission.to_csv(\"/kaggle/working/submission.csv\", index=False)"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "databundleVersionId": 14993753,
     "sourceId": 119082,
     "sourceType": "competition"
    }
   ],
   "dockerImageVersionId": 31234,
   "isGpuEnabled": false,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.12"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 15.22675,
   "end_time": "2026-01-04T00:39:36.002972",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2026-01-04T00:39:20.776222",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
